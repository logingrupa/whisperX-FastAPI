---
phase: 03-build-integration-spa-serving
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - frontend/package.json
  - frontend/vite.config.ts
  - frontend/tsconfig.json
  - frontend/tsconfig.node.json
  - frontend/index.html
  - frontend/src/main.tsx
  - frontend/src/App.tsx
  - frontend/src/index.css
  - frontend/src/vite-env.d.ts
autonomous: true

must_haves:
  truths:
    - "Vite dev server starts without errors"
    - "React app renders in browser at localhost:5173"
    - "Tailwind CSS classes apply correctly"
    - "Loading skeleton displays while JS loads"
    - "Noscript fallback shows friendly message"
  artifacts:
    - path: "frontend/package.json"
      provides: "Frontend dependencies and scripts"
      contains: "vite"
    - path: "frontend/vite.config.ts"
      provides: "Vite configuration with base path and proxy"
      contains: "base: '/ui/'"
    - path: "frontend/index.html"
      provides: "HTML shell with skeleton and noscript"
      contains: "app-skeleton"
    - path: "frontend/src/App.tsx"
      provides: "React root component"
      exports: ["default"]
  key_links:
    - from: "frontend/vite.config.ts"
      to: "localhost:8000"
      via: "proxy configuration"
      pattern: "proxy.*localhost:8000"
    - from: "frontend/index.html"
      to: "frontend/src/main.tsx"
      via: "script module"
      pattern: "src/main.tsx"
---

<objective>
Create the React frontend project using Vite with TypeScript, Tailwind CSS, and proper configuration for serving from FastAPI's /ui route.

Purpose: Establishes the frontend foundation that will host all UI components in Phases 4-6. The base path configuration ensures assets load correctly when served from FastAPI.

Output: A working Vite + React + TypeScript project in frontend/ with dev server, skeleton loading, and noscript fallback.
</objective>

<execution_context>
@C:\Users\rolan\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\rolan\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-build-integration-spa-serving/03-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Scaffold Vite + React + TypeScript Project</name>
  <files>
    frontend/package.json
    frontend/tsconfig.json
    frontend/tsconfig.node.json
    frontend/src/main.tsx
    frontend/src/App.tsx
    frontend/src/vite-env.d.ts
  </files>
  <action>
Create the frontend project using Bun (per project decision - Bun only for package management):

1. Create frontend directory and initialize Vite React-TS template:
   ```bash
   cd C:\laragon\www\whisperx
   bunx --bun create-vite frontend --template react-ts
   cd frontend
   bun install
   ```

2. Install additional dependencies:
   ```bash
   bun add react-router-dom
   bun add -D @tailwindcss/vite @types/node concurrently
   ```

3. Configure tsconfig.json for path aliases (per shadcn/ui convention):
   - Add baseUrl: "."
   - Add paths: { "@/*": ["./src/*"] }

4. Create minimal App.tsx that displays "WhisperX" heading (placeholder for Phase 4).

Note: Use Bun's bunx command, not npx. The --bun flag ensures Bun runtime is used.
  </action>
  <verify>
    - `bun run dev` starts Vite dev server on port 5173
    - Browser shows React app at http://localhost:5173
    - No TypeScript errors in console
  </verify>
  <done>
    - frontend/ directory exists with package.json, tsconfig.json, src/
    - React app renders "WhisperX" heading in browser
    - TypeScript compilation succeeds
  </done>
</task>

<task type="auto">
  <name>Task 2: Configure Vite with Base Path, Proxy, and Tailwind</name>
  <files>
    frontend/vite.config.ts
    frontend/src/index.css
  </files>
  <action>
Update vite.config.ts with production and development configuration:

1. Set base: '/ui/' for production asset paths (CRITICAL - must match FastAPI mount point)

2. Configure dev server proxy for all API endpoints:
   - /speech-to-text -> http://localhost:8000
   - /tasks -> http://localhost:8000
   - /health -> http://localhost:8000
   - /upload -> http://localhost:8000
   - /ws -> ws://localhost:8000 (with ws: true for WebSocket upgrade)

3. Add Tailwind CSS Vite plugin:
   - import tailwindcss from '@tailwindcss/vite'
   - Add to plugins array

4. Configure path alias:
   - resolve.alias: { '@': path.resolve(__dirname, './src') }

5. Update src/index.css for Tailwind v4:
   - Add @import "tailwindcss" at top (Tailwind v4 CSS-first syntax)

Per research: Use @tailwindcss/vite plugin (Tailwind v4), not PostCSS config.
  </action>
  <verify>
    - vite.config.ts contains base: '/ui/'
    - vite.config.ts contains proxy configuration for /ws with ws: true
    - `bun run dev` starts without Tailwind errors
    - Tailwind classes (e.g., bg-blue-500) work in App.tsx
  </verify>
  <done>
    - Vite configured for /ui/ base path
    - All API routes proxied to localhost:8000
    - WebSocket proxy configured with ws: true
    - Tailwind CSS functional
  </done>
</task>

<task type="auto">
  <name>Task 3: Create index.html with Skeleton and Noscript Fallback</name>
  <files>
    frontend/index.html
  </files>
  <action>
Replace the default index.html with custom version containing:

1. Inline CSS for loading skeleton (displays immediately, before React loads):
   - .app-skeleton container with max-width and padding
   - .skeleton-header (48px height, shimmer animation)
   - .skeleton-card (200px height, shimmer animation)
   - .skeleton-row with .skeleton-item children (flex layout)
   - @keyframes shimmer animation (background-position 200% to -200%)
   - CSS to hide skeleton when #root has content: #root:not(:empty) + .app-skeleton { display: none; }

2. Skeleton HTML structure (sibling of #root, NOT inside):
   ```html
   <div id="root"></div>
   <div class="app-skeleton">
     <div class="skeleton-header"></div>
     <div class="skeleton-card"></div>
     <div class="skeleton-row">
       <div class="skeleton-item"></div>
       <div class="skeleton-item"></div>
       <div class="skeleton-item"></div>
     </div>
   </div>
   ```

3. Noscript fallback with friendly message (per user decision - casual tone):
   - Beautiful gradient background (#667eea to #764ba2)
   - Centered content with icon
   - Title: "Hey! This app needs a modern browser"
   - Message: "WhisperX requires JavaScript to work its magic. Please enable JavaScript or try a different browser to get started with transcription."

4. Script tag pointing to /ui/src/main.tsx (includes base path for dev)

Per research: Skeleton must be SIBLING of #root for CSS :not(:empty) selector to work.
  </action>
  <verify>
    - Loading skeleton visible briefly on page load
    - Skeleton disappears when React renders
    - Disabling JavaScript shows friendly noscript message
    - No emoji in noscript message (per project conventions)
  </verify>
  <done>
    - index.html contains inline skeleton CSS and HTML
    - Shimmer animation works on skeleton elements
    - Noscript shows friendly browser requirement message
    - Skeleton hides automatically when React mounts
  </done>
</task>

</tasks>

<verification>
After all tasks complete:
1. `cd frontend && bun run dev` starts Vite on port 5173
2. http://localhost:5173 shows skeleton briefly, then React app
3. Tailwind classes apply correctly (test with bg-blue-500)
4. Browser DevTools shows no console errors
5. View page source shows skeleton HTML and noscript fallback
</verification>

<success_criteria>
- Vite dev server starts and serves React app
- Base path /ui/ configured for production builds
- Proxy configured for all API and WebSocket endpoints
- Tailwind CSS works via @tailwindcss/vite plugin
- Loading skeleton displays and auto-hides
- Noscript shows friendly message with casual tone
</success_criteria>

<output>
After completion, create `.planning/phases/03-build-integration-spa-serving/03-01-SUMMARY.md`
</output>
